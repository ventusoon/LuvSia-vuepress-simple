(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{252:function(t,s,e){"use strict";e.r(s);var a=e(14),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[s("em",[s("strong",[t._v("Automatically deploying the Front End to the server using GitHub Actions")])])])]),t._v(" "),s("h2",{attrs:{id:"github-actionsä»‹ç»åŠåŸç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#github-actionsä»‹ç»åŠåŸç†"}},[t._v("#")]),t._v(" GitHub Actionsä»‹ç»åŠåŸç†")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("æ¥è§¦ "),s("strong",[t._v("GitHub Actions")]),t._v(" ä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œç›®å‰æ­¤blogå°±æ˜¯åˆ©ç”¨ "),s("strong",[t._v("GitHub Action")]),t._v(" "),s("RouterLink",{attrs:{to:"/hello-world/#è‡ªåŠ¨éƒ¨ç½²åˆ°å…¬å¼€ä»“åº“"}},[t._v("è‡ªåŠ¨éƒ¨ç½²åˆ°GitHubæ‰˜ç®¡")]),t._v("çš„ã€‚ä»Šå¤©æŠŠæ­¤æ¬¡å‰ç«¯é¡µé¢æˆåŠŸéƒ¨ç½²åˆ°æœåŠ¡å™¨ç«¯çš„æ“ä½œæ–¹æ³•è¯¦ç»†è®°å½•ä¸‹æ¥ï¼Œé¡ºä¾¿æŒ‰è‡ªå·±ç†è§£å†™äº›å¿ƒå¾—ã€‚æŠ½ç©ºå†ç å­—å®Œå–„ï¼ˆä¸‹ç­æ—¶é—´å¼€å·¥ğŸ˜­ï¼‰ã€‚")],1)]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://docs.github.com/zh/actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Actions å®˜æ–¹æ–‡æ¡£"),s("OutboundLink")],1),t._v("ï¼šåœ¨ GitHub Actions çš„ä»“åº“ä¸­è‡ªåŠ¨åŒ–ã€è‡ªå®šä¹‰å’Œæ‰§è¡Œè½¯ä»¶å¼€å‘å·¥ä½œæµç¨‹ã€‚ æ‚¨å¯ä»¥å‘ç°ã€åˆ›å»ºå’Œå…±äº«æ“ä½œä»¥æ‰§è¡Œæ‚¨å–œæ¬¢çš„ä»»ä½•ä½œä¸šï¼ˆåŒ…æ‹¬ CI/CDï¼‰ï¼Œå¹¶å°†æ“ä½œåˆå¹¶åˆ°å®Œå…¨è‡ªå®šä¹‰çš„å·¥ä½œæµç¨‹ä¸­ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("é€šè¿‡æ–‡æ¡£å¯ä»¥çœ‹å‡º "),s("strong",[t._v("GitHub Action")]),t._v(" å…¶å¼ºå¤§çš„ä»£ç ç®¡ç†ã€è¿è¡Œéƒ¨ç½²ã€æµ‹è¯•æ¨é€ç­‰ä¸€ä½“åŒ–è‡ªåŠ¨å‘å¸ƒéƒ¨ç½²åŠŸèƒ½ï¼Œçœå»äº†å¤§é‡çš„é‡å¤æ€§å·¥ä½œã€‚ç”±äºé€šè¿‡sshå®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œç›´æ¥è¿›è¡Œå‰ç«¯éƒ¨ç½²ï¼Œéœ€è¦å®‰è£…å„ç§å„æ ·çš„ä¾èµ–ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šé™ä½äº†æœåŠ¡å™¨è¿è¡Œæ•ˆç‡ï¼Œä¸”ä¸æ˜“å¯¹ä»£ç è¿›è¡Œä¿®æ­£ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("æœ¬æ•™ç¨‹æ˜¯åœ¨"),s("RouterLink",{attrs:{to:"/nginx-proxy-manager/"}},[t._v("ã€Šç”¨Nginx Proxy Manageréƒ¨ç½²é™æ€ç½‘é¡µã€‹")]),t._v("åŸºç¡€ä¸Šå»¶ä¼¸å‡ºçš„æ€è·¯ï¼Œçœå»äº†å®‰è£…nodeç¯å¢ƒå’Œå„ç§ä¾èµ–çš„æ­¥éª¤ï¼Œç›´æ¥åœ¨ "),s("strong",[t._v("GitHub Action")]),t._v(" ä¸­éƒ¨ç½²å‰ç«¯ã€‚æ¯æ¬¡åœ¨æœ¬åœ°å¯¹åç«¯æ–‡ä»¶è¿›è¡Œä¿®æ­£åï¼Œç›´æ¥å°†å‰ç«¯å‘å¸ƒåˆ°æœåŠ¡å™¨ã€‚èµ·åˆ°ä¸€åŠ³æ°¸é€¸çš„æ•ˆæœã€‚")],1)])]),t._v(" "),s("details",[s("summary",[t._v("\nGitHub Action æˆåŠŸç¤ºå›¾\n")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/github-actions-deploy/1.png",alt:"GitHub ActionæˆåŠŸç•Œé¢"}})])]),t._v(" "),s("ul",[s("li",[t._v("ç¤ºä¾‹åˆ†æï¼Œä»¥"),s("RouterLink",{attrs:{to:"/hello-world/#è‡ªåŠ¨éƒ¨ç½²åˆ°GitHubæ‰˜ç®¡"}},[t._v("è‡ªåŠ¨éƒ¨ç½²åˆ°GitHubæ‰˜ç®¡")]),t._v("ä¸ºä¾‹ï¼Œåˆ†æ "),s("strong",[t._v("GitHub Action")]),t._v(" å·¥ä½œæµç¨‹å¦‚ä¸‹")],1)]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("name: luvsia-hugo-blog-autodeploy "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å·¥ä½œæµç¨‹åç§°ï¼Œè‡ªè¡Œå‘½å")]),t._v("\n\non:\n  push: "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä»€ä¹ˆæ—¶å€™è¯·æ±‚è§¦å‘")]),t._v("\n    branches:\n      - main  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä½œç”¨åˆ†æ”¯ï¼Œè¿™é‡Œæ˜¯mainï¼Œä¹Ÿå¯æ˜¯master")]),t._v("\n  pull_request:\n\njobs: "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å°†å·¥ä½œæµæ–‡ä»¶ä¸­è¿è¡Œçš„æ‰€æœ‰ä»»åŠ¡åˆ†ç»„åœ¨ä¸€èµ·")]),t._v("\n  deploy:\n    runs-on: ubuntu-latest\n    concurrency:\n      group: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ github.workflow }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("-"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ github.ref }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    steps:\n      - uses: actions/checkout@v2\n        with:               "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¦‚æœä½ å®‰è£…ä¸»é¢˜æ—¶ç”¨çš„æ˜¯git submodule add")]),t._v("\n          submodules: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é‚£ä¹ˆè¿™ä¸‰è¡Œä¸å¿…æ³¨é‡Šæ‰ï¼Œè¿™ä¸€è¡Œå¡«å†™ true")]),t._v("\n          fetch-depth: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Fetch all history for .GitInfo and .Lastmod")]),t._v("\n\n      - name: Setup Hugo\n        uses: peaceiris/actions-hugo@v2\n        with:\n          hugo-version: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'latest'")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è·å–æœ€æ–°ç‰ˆæœ¬çš„hugo")]),t._v("\n          extended: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¦‚æœä½ ä½¿ç”¨çš„ä¸æ˜¯extendedç‰ˆæœ¬çš„hugoï¼Œå°†trueæ”¹ä¸ºfalse")]),t._v("\n\n      - name: Build\n        run: hugo   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä½¿ç”¨hugoæ„å»ºé™æ€ç½‘é¡µ")]),t._v("\n\n      - name: Deploy to github\n        uses: peaceiris/actions-gh-pages@v3\n        if: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ github.ref == 'refs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("heads"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("main' }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ³¨æ„å¡«å†™mainæˆ–è€…master")]),t._v("\n        with:\n          personal_token: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.PERSONAL_TOKEN }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¦‚æœsecretå–äº†å…¶ä»–åç§°ï¼Œå°†PERSONAL_TOKENæ›¿æ¢æ‰")]),t._v("\n          external_repository: ventusoon/LuvSia "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¡«å†™è¿œç¨‹ public ä»“åº“ ")]),t._v("\n          publish_dir: ./public\n          cname: luvsia.com        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¡«å†™è‡ªå®šä¹‰åŸŸå")]),t._v("\n")])])]),s("ul",[s("li",[t._v("æŒ‰ç…§ç¤ºä¾‹åˆ†æï¼Œå¯ä»¥å¾—å‡ºç®€å•çš„ "),s("strong",[t._v("GitHub Actions")]),t._v(" æ­¥éª¤å›¾å¦‚ä¸‹")])]),t._v(" "),s("blockquote",[s("p",[t._v("Action")]),t._v(" "),s("blockquote",[s("p",[t._v("1ï¸âƒ£ä½œç”¨æ¡ä»¶")]),t._v(" "),s("blockquote",[s("p",[t._v("æ—¶é—´èŠ‚ç‚¹")]),t._v(" "),s("p",[t._v("åˆ†æ”¯")])]),t._v(" "),s("p",[t._v("2ï¸âƒ£å·¥ä½œä»»åŠ¡")]),t._v(" "),s("blockquote",[s("p",[t._v("è¿è¡Œç¯å¢ƒ")]),t._v(" "),s("p",[t._v("æ­¥éª¤ä¸€")]),t._v(" "),s("p",[t._v("æ­¥éª¤äºŒ")]),t._v(" "),s("p",[t._v("æ­¥éª¤ N")]),t._v(" "),s("p",[t._v("ç›´æ¥å‘å¸ƒåˆ°æœåŠ¡å™¨/æœ¬åœ°/æ‰˜ç®¡é¡µé¢")])])])]),t._v(" "),s("h2",{attrs:{id:"å®æˆ˜æ¼”ç»ƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®æˆ˜æ¼”ç»ƒ"}},[t._v("#")]),t._v(" å®æˆ˜æ¼”ç»ƒ")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("å› ä¸ºè¦éƒ¨ç½²åˆ°æœåŠ¡å™¨ç«¯ï¼Œæ‰€ä»¥è¦äº†è§£è¿æ¥åˆ°æœåŠ¡å™¨çš„æ–¹å¼ï¼Œè¿™é‡Œé€‰æ‹©sshè¿æ¥ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ä¹Ÿç”¨äº†sftpè¿æ¥ï¼Œéƒ½å¯ä»¥ã€‚")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("GitHub Actions")]),t._v(" éƒ¨ç½²æ–‡ä»¶é€šå¸¸ä»¥ "),s("code",[t._v("xxx.yml")]),t._v(" å‘½åï¼Œè·¯å¾„ä¸ºé¡¹ç›®æ ¹ç›®å½•ä¸‹ "),s("code",[t._v("/.github/workflows/xxx.yml")]),t._v(" ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("åœ¨ "),s("strong",[t._v("GitHub")]),t._v(" é¡µé¢ä¸‹ç¼–è¾‘ "),s("code",[t._v("xxx.yml")]),t._v(" ,å¯ä»¥å‘ç°å³ä¾§çš„"),s("strong",[t._v("åº”ç”¨å•†åŸ")]),t._v("ä¸­æœ‰å¾ˆå¤šç‰¹è‰²Actionsï¼Œå› ä¸ºæ˜¯sshè¿æ¥ï¼Œåœ¨è¿™é‡Œé€‰æ‹©è¯„åˆ†è¾ƒé«˜çš„ "),s("code",[t._v("ssh-deploy")]),t._v(" åº”ç”¨ï¼Œå¹¶ä½¿ç”¨æœ€æ–°ç‰ˆã€‚")])])]),t._v(" "),s("details",[s("summary",[t._v("\nssh-deploy åº”ç”¨\n")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/github-actions-deploy/2.png",alt:"ssh-deploy"}})])]),t._v(" "),s("ul",[s("li",[t._v("åœ¨"),s("a",{attrs:{href:"https://github.com/easingthemes/ssh-deploy",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://img.shields.io/badge/GitHubAction-easingthemes/ssh--deploy-cyan?logo=github",alt:""}}),s("OutboundLink")],1),t._v("é¡¹ç›®ä¸­çš„ README ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸»è¦é…ç½®åç§°åŠç”¨é€”å¦‚ä¸‹ã€‚")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("é…ç½®åç§°")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("ç”¨é€”")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("ç¤ºä¾‹")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SSH_PRIVATE_KEY")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("SSHå¯†é’¥")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("å¯†é’¥åº”ä½¿ç”¨PEMæ ¼å¼ç”Ÿæˆ")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("REMOTE_HOST")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("è¿œç¨‹ä¸»æœº")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("10.10.10.10")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("REMOTE_USER")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ç”¨æˆ·")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("root")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("REMOTE_PORT")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ç«¯å£")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("é»˜è®¤22")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SOURCE")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("æºï¼Œéœ€è¦éƒ¨ç½²çš„å†…å®¹")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("/dist")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("TARGET")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("å¯¹è±¡ï¼Œè¦éƒ¨ç½²çš„è·¯å¾„")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("/data/docker_data/npm/data/sub.ven2s.cn/")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("ARGS")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ä¼ é€’ç»™rsyncï¼ˆåŒæ­¥æ—¶ï¼‰çš„å‚æ•°")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("-avz --delete")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SSH_CMD_ARGS")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ä¸€ç»„sshå‚æ•°ï¼Œå®ƒä»¬å¿…é¡»ä»¥-oä¸ºå‰ç¼€ï¼Œç”¨é€—å·åˆ†éš”")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("-o SomeArgument=noï¼Œ-o SomeOtherArgument=5")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("EXCLUDE")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("è¦æ’é™¤çš„è·¯å¾„ï¼Œç”¨é€—å·åˆ†éš”")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("/dist/, /node_modules/")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SCRIPT_BEFORE")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("åœ¨åŒæ­¥ä¹‹å‰åœ¨ä¸»æœºä¸Šè¿è¡Œçš„è„šæœ¬")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("mkdir -p /data/docker_data/npm/data/sub.ven2s.cn")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SCRIPT_AFTER")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("åœ¨åŒæ­¥ä¹‹ååœ¨ä¸»æœºä¸Šè¿è¡Œçš„è„šæœ¬")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("reboot")])])])])]),t._v(" "),s("ul",[s("li",[t._v("åšå¥½ä»¥ä¸Šå‰æœŸå·¥ä½œï¼Œç°åœ¨å¯ä»¥å¼€å§‹æ“ä½œäº†")])]),t._v(" "),s("h3",{attrs:{id:"åœ¨æœåŠ¡å™¨ç«¯é…ç½®å¯†é’¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åœ¨æœåŠ¡å™¨ç«¯é…ç½®å¯†é’¥"}},[t._v("#")]),t._v(" åœ¨æœåŠ¡å™¨ç«¯é…ç½®å¯†é’¥")]),t._v(" "),s("ul",[s("li",[t._v("åœ¨ "),s("code",[t._v("root")]),t._v(" ç›®å½•ä¸‹ï¼Œè¾“å…¥")])]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("keygen "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("m PEM "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t rsa "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v("\n\n# ç”Ÿæˆå¯†é’¥æ–‡ä»¶ï¼Œè¿ç»­æŒ‰ä¸‹ä¸¤æ¬¡å›è½¦ã€‚\n# è¯·æ³¨æ„ï¼šæ‚¨ä¸åº”è¯¥ä¸ºæ‚¨ç”Ÿæˆçš„ç§é’¥è®¾ç½®å¯†ç ï¼ˆå°†å…¶ä¿ç•™ä¸ºç©ºï¼‰ã€‚å› ä¸º rsync sshï¼ˆç”¨äºéƒ¨ç½²ï¼‰ä¸æ”¯æŒå°†ç§é’¥å¯†ç ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°è¾“å…¥ã€‚\n")])])]),s("ul",[s("li",[t._v("æ­¤æ—¶ï¼Œ "),s("code",[t._v("/root/.ssh/")]),t._v(" ä¸‹ç”Ÿæˆäº†ç§é’¥æ–‡ä»¶ "),s("code",[t._v("id_dsa")]),t._v(" ã€å…¬é’¥æ–‡ä»¶"),s("code",[t._v("id_dsa.pub")]),t._v(" ï¼Œæ ¹æ®å…¬é’¥æ–‡ä»¶ç”Ÿæˆ"),s("code",[t._v("authorized_keys")]),t._v(" ï¼Œå¹¶ç»™ä»¥ä¸Šä¸‰ä¸ªæ–‡ä»¶åˆ†åˆ«è®¾ç½®æƒé™ã€‚")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("cat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("id_rsa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pub "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("authorized_keys\n")])])]),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("chmod "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("id_rsa\n")])])]),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("chmod "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("id_rsa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pub\n")])])]),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("chmod "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("authorized_keys\n")])])]),s("ul",[s("li",[t._v("æ­¤æ—¶ï¼Œå®¢è§‚ä¸ŠæœåŠ¡å™¨ç«¯çš„å·¥ä½œå°±å®Œæˆäº†ï¼Œå¦‚æœè¿æ¥ä¸­é‡åˆ°å„ç§é”™è¯¯æç¤ºï¼Œè¯·è‡ªè¡Œ "),s("strong",[t._v("goggle")]),t._v(" ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"é¡¹ç›®ä¸­è®¾ç½®ä»“åº“å¯†é’¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é¡¹ç›®ä¸­è®¾ç½®ä»“åº“å¯†é’¥"}},[t._v("#")]),t._v(" é¡¹ç›®ä¸­è®¾ç½®ä»“åº“å¯†é’¥")]),t._v(" "),s("ul",[s("li",[t._v("è¯´æ¥çœŸæ˜¯å‘ï¼Œæœ€å¼€å§‹æŠŠ"),s("strong",[t._v("ä»“åº“å¯†é’¥")]),t._v("é”™å¡«åˆ°"),s("strong",[t._v("ä»£ç ç©ºé—´æœºå¯†")]),t._v("ä¸­ï¼Œä¸€ç›´è¿æ¥ä¸ä¸Šï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯æœåŠ¡å™¨çš„é—®é¢˜ï¼Œå‰å¤©ç”šè‡³å¼„ææƒšäº†ï¼Œä¸å°å¿ƒ "),s("code",[t._v("rm -rf /")]),t._v(" äº†......")])]),t._v(" "),s("details",[s("summary",[t._v("\nä»“åº“æœºå¯†åœ¨GitHubé¡¹ç›®ä¸­è®¾ç½®çš„ä½ç½®\n")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/github-actions-deploy/3.png",alt:""}})])]),t._v(" "),s("ul",[s("li",[t._v("åœ¨æœåŠ¡å™¨ä¸­ "),s("code",[t._v("cat")]),t._v(" å¯†é’¥ï¼Œå°†æ‰€æœ‰å†…å®¹å¤åˆ¶åˆ°ä¸Šå›¾çš„ "),s("strong",[t._v("SSH_PRIVATE_KEY")]),t._v(" ä¸­ï¼Œå¹¶å¡«å…¥æœåŠ¡å™¨IPåˆ° "),s("strong",[t._v("REMOTE_HOST")]),t._v(" ï¼Œå¡«å…¥ "),s("code",[t._v("root")]),t._v(" åˆ° "),s("strong",[t._v("REMOTE_USER")]),t._v("ã€‚ï¼ˆæˆ–è€…ç›´æ¥åœ¨ymlæ–‡ä»¶ä¸­å¡«å…¥ "),s("strong",[t._v('"root"')]),t._v(" ï¼‰")])]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("cat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("id_rsa\n")])])]),s("p",[t._v("æˆ–è€…")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("REMOTE_USER"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v("\n")])])]),s("h3",{attrs:{id:"å‘å¸ƒéƒ¨ç½²æ–‡ä»¶åˆ°è¿œç«¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‘å¸ƒéƒ¨ç½²æ–‡ä»¶åˆ°è¿œç«¯"}},[t._v("#")]),t._v(" å‘å¸ƒéƒ¨ç½²æ–‡ä»¶åˆ°è¿œç«¯")]),t._v(" "),s("ul",[s("li",[t._v("æˆ‘æŠŠè‡ªåŠ¨å‘å¸ƒnginx-proxy-manageré™æ€é¡µé¢çš„æ–‡ä»¶poåœ¨ä¸‹é¢ï¼Œè¯·æ ¹æ®è‡ªèº«çš„è¿è¡Œç¯å¢ƒå’Œä¾èµ–è¿›è¡Œä¿®æ”¹é…ç½®å³å¯ã€‚")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å½“å‰å·¥ä½œæµçš„åç§°")]),t._v("\nname: sub-web-deploy\non:\n  push:\n    branches:\n      - master\n\njobs: "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ„å»ºçš„ä»»åŠ¡ï¼Œä¸€ä¸ªå·¥ä½œæµæœ‰å¤šä¸ªæ„å»ºä»»åŠ¡ï¼Œ")]),t._v("\n  build-and-deploy:\n    runs-on: ubuntu-latest "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åœ¨ä»€ä¹ˆæœåŠ¡å™¨ä¸Šé¢æ‰§è¡Œè¿™äº›ä»»åŠ¡ï¼Œè¿™é‡Œä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ubuntu")]),t._v("\n    \n    steps: "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ„å»ºä»»åŠ¡çš„æ­¥éª¤ï¼Œä¸€ä¸ªä»»åŠ¡å¯åˆ†ä¸ºå¤šä¸ªæ­¥éª¤")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åˆ‡æ¢åˆ†æ”¯")]),t._v("\n      - name: Checkout\n        uses: actions/checkout@v4\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ­¥éª¤2 ç»™å½“å‰æœåŠ¡å™¨å®‰è£…node")]),t._v("\n      - name: use "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),t._v("\n        uses: actions/setup-node@v3.8.1\n        with:\n          node-version: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\n          cache: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ­¥éª¤3 ä¸‹è½½é¡¹ç›®ä¾èµ–    ")]),t._v("\n      - name: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n        run: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ­¥éª¤4 æ‰“åŒ…nodeé¡¹ç›®")]),t._v("\n      - name: build\n        run: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" build\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ­¥éª¤5 éƒ¨ç½²é¡¹ç›®åˆ°æœåŠ¡å™¨")]),t._v("\n      - name: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" deploy\n        uses: easingthemes/ssh-deploy@v4.1.10\n        with:\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Private key part of an SSH key pair")]),t._v("\n          SSH_PRIVATE_KEY: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.SSH_PRIVATE_KEY }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Remote host")]),t._v("\n          REMOTE_HOST: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.REMOTE_HOST }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Remote user")]),t._v("\n          REMOTE_USER: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.REMOTE_USER }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Source directory, path relative to `$GITHUB_WORKSPACE` root, eg: `dist/`")]),t._v("\n          SOURCE: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/dist/"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Script to run on host machine before rsync")]),t._v("\n          SCRIPT_BEFORE: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mkdir -p /data/docker_data/npm/data/sub.ven2s.cn"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Target directory")]),t._v("\n          TARGET: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/data/docker_data/npm/data/sub.ven2s.cn/"')]),t._v("\n")])])]),s("h2",{attrs:{id:"å¦‚æœå–œæ¬¢è¯·åˆ†äº«æ­¤é¡µé¢-å¦‚æœ‰ç–‘é—®è¯·æŒ‰f5-å†è¿›è¡Œè¯„è®ºã€‚å“ˆå“ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚æœå–œæ¬¢è¯·åˆ†äº«æ­¤é¡µé¢-å¦‚æœ‰ç–‘é—®è¯·æŒ‰f5-å†è¿›è¡Œè¯„è®ºã€‚å“ˆå“ˆ"}},[t._v("#")]),t._v(" å¦‚æœå–œæ¬¢è¯·åˆ†äº«æ­¤é¡µé¢ï¼Œå¦‚æœ‰ç–‘é—®è¯·æŒ‰F5ï¼Œå†è¿›è¡Œè¯„è®ºã€‚å“ˆå“ˆ")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/github-actions-deploy/4.png",alt:""}})])])}),[],!1,null,null,null);s.default=n.exports}}]);