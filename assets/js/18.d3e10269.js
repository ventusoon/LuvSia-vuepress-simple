(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{252:function(t,s,e){"use strict";e.r(s);var a=e(14),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[s("em",[s("strong",[t._v("Automatically deploying the Front End to the server using GitHub Actions")])])])]),t._v(" "),s("h2",{attrs:{id:"github-actions介绍及原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#github-actions介绍及原理"}},[t._v("#")]),t._v(" GitHub Actions介绍及原理")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("接触 "),s("strong",[t._v("GitHub Actions")]),t._v(" 也有一段时间了，目前此blog就是利用 "),s("strong",[t._v("GitHub Action")]),t._v(" "),s("RouterLink",{attrs:{to:"/hello-world/#自动部署到公开仓库"}},[t._v("自动部署到GitHub托管")]),t._v("的。今天把此次前端页面成功部署到服务器端的操作方法详细记录下来，顺便按自己理解写些心得。抽空再码字完善（下班时间开工😭）。")],1)]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://docs.github.com/zh/actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Actions 官方文档"),s("OutboundLink")],1),t._v("：在 GitHub Actions 的仓库中自动化、自定义和执行软件开发工作流程。 您可以发现、创建和共享操作以执行您喜欢的任何作业（包括 CI/CD），并将操作合并到完全自定义的工作流程中。")])]),t._v(" "),s("li",[s("p",[t._v("通过文档可以看出 "),s("strong",[t._v("GitHub Action")]),t._v(" 其强大的代码管理、运行部署、测试推送等一体化自动发布部署功能，省去了大量的重复性工作。由于通过ssh客户端连接到服务器，直接进行前端部署，需要安装各种各样的依赖，很大程度上降低了服务器运行效率，且不易对代码进行修正。")])]),t._v(" "),s("li",[s("p",[t._v("本教程是在"),s("RouterLink",{attrs:{to:"/nginx-proxy-manager/"}},[t._v("《用Nginx Proxy Manager部署静态网页》")]),t._v("基础上延伸出的思路，省去了安装node环境和各种依赖的步骤，直接在 "),s("strong",[t._v("GitHub Action")]),t._v(" 中部署前端。每次在本地对后端文件进行修正后，直接将前端发布到服务器。起到一劳永逸的效果。")],1)])]),t._v(" "),s("details",[s("summary",[t._v("\nGitHub Action 成功示图\n")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/github-actions-deploy/1.png",alt:"GitHub Action成功界面"}})])]),t._v(" "),s("ul",[s("li",[t._v("示例分析，以"),s("RouterLink",{attrs:{to:"/hello-world/#自动部署到GitHub托管"}},[t._v("自动部署到GitHub托管")]),t._v("为例，分析 "),s("strong",[t._v("GitHub Action")]),t._v(" 工作流程如下")],1)]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("name: luvsia-hugo-blog-autodeploy "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 工作流程名称，自行命名")]),t._v("\n\non:\n  push: "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 什么时候请求触发")]),t._v("\n    branches:\n      - main  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 作用分支，这里是main，也可是master")]),t._v("\n  pull_request:\n\njobs: "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将工作流文件中运行的所有任务分组在一起")]),t._v("\n  deploy:\n    runs-on: ubuntu-latest\n    concurrency:\n      group: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ github.workflow }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("-"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ github.ref }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    steps:\n      - uses: actions/checkout@v2\n        with:               "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你安装主题时用的是git submodule add")]),t._v("\n          submodules: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 那么这三行不必注释掉，这一行填写 true")]),t._v("\n          fetch-depth: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Fetch all history for .GitInfo and .Lastmod")]),t._v("\n\n      - name: Setup Hugo\n        uses: peaceiris/actions-hugo@v2\n        with:\n          hugo-version: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'latest'")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取最新版本的hugo")]),t._v("\n          extended: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你使用的不是extended版本的hugo，将true改为false")]),t._v("\n\n      - name: Build\n        run: hugo   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用hugo构建静态网页")]),t._v("\n\n      - name: Deploy to github\n        uses: peaceiris/actions-gh-pages@v3\n        if: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ github.ref == 'refs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("heads"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("main' }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意填写main或者master")]),t._v("\n        with:\n          personal_token: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.PERSONAL_TOKEN }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果secret取了其他名称，将PERSONAL_TOKEN替换掉")]),t._v("\n          external_repository: ventusoon/LuvSia "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 填写远程 public 仓库 ")]),t._v("\n          publish_dir: ./public\n          cname: luvsia.com        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 填写自定义域名")]),t._v("\n")])])]),s("ul",[s("li",[t._v("按照示例分析，可以得出简单的 "),s("strong",[t._v("GitHub Actions")]),t._v(" 步骤图如下")])]),t._v(" "),s("blockquote",[s("p",[t._v("Action")]),t._v(" "),s("blockquote",[s("p",[t._v("1️⃣作用条件")]),t._v(" "),s("blockquote",[s("p",[t._v("时间节点")]),t._v(" "),s("p",[t._v("分支")])]),t._v(" "),s("p",[t._v("2️⃣工作任务")]),t._v(" "),s("blockquote",[s("p",[t._v("运行环境")]),t._v(" "),s("p",[t._v("步骤一")]),t._v(" "),s("p",[t._v("步骤二")]),t._v(" "),s("p",[t._v("步骤 N")]),t._v(" "),s("p",[t._v("直接发布到服务器/本地/托管页面")])])])]),t._v(" "),s("h2",{attrs:{id:"实战演练"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实战演练"}},[t._v("#")]),t._v(" 实战演练")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("因为要部署到服务器端，所以要了解连接到服务器的方式，这里选择ssh连接，网上有很多教程也用了sftp连接，都可以。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("GitHub Actions")]),t._v(" 部署文件通常以 "),s("code",[t._v("xxx.yml")]),t._v(" 命名，路径为项目根目录下 "),s("code",[t._v("/.github/workflows/xxx.yml")]),t._v(" 。")])]),t._v(" "),s("li",[s("p",[t._v("在 "),s("strong",[t._v("GitHub")]),t._v(" 页面下编辑 "),s("code",[t._v("xxx.yml")]),t._v(" ,可以发现右侧的"),s("strong",[t._v("应用商城")]),t._v("中有很多特色Actions，因为是ssh连接，在这里选择评分较高的 "),s("code",[t._v("ssh-deploy")]),t._v(" 应用，并使用最新版。")])])]),t._v(" "),s("details",[s("summary",[t._v("\nssh-deploy 应用\n")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/github-actions-deploy/2.png",alt:"ssh-deploy"}})])]),t._v(" "),s("ul",[s("li",[t._v("在"),s("a",{attrs:{href:"https://github.com/easingthemes/ssh-deploy",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://img.shields.io/badge/GitHubAction-easingthemes/ssh--deploy-cyan?logo=github",alt:""}}),s("OutboundLink")],1),t._v("项目中的 README 中，可以看到其主要配置名称及用途如下。")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("配置名称")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("用途")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SSH_PRIVATE_KEY")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("SSH密钥")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("密钥应使用PEM格式生成")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("REMOTE_HOST")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("远程主机")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("10.10.10.10")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("REMOTE_USER")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("用户")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("root")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("REMOTE_PORT")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("端口")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("默认22")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SOURCE")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("源，需要部署的内容")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("/dist")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("TARGET")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("对象，要部署的路径")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("/data/docker_data/npm/data/sub.ven2s.cn/")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("ARGS")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("传递给rsync（同步时）的参数")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("-avz --delete")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SSH_CMD_ARGS")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("一组ssh参数，它们必须以-o为前缀，用逗号分隔")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("-o SomeArgument=no，-o SomeOtherArgument=5")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("EXCLUDE")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("要排除的路径，用逗号分隔")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("/dist/, /node_modules/")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SCRIPT_BEFORE")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("在同步之前在主机上运行的脚本")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("mkdir -p /data/docker_data/npm/data/sub.ven2s.cn")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("SCRIPT_AFTER")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("在同步之后在主机上运行的脚本")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("reboot")])])])])]),t._v(" "),s("ul",[s("li",[t._v("做好以上前期工作，现在可以开始操作了")])]),t._v(" "),s("h3",{attrs:{id:"在服务器端配置密钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在服务器端配置密钥"}},[t._v("#")]),t._v(" 在服务器端配置密钥")]),t._v(" "),s("ul",[s("li",[t._v("在 "),s("code",[t._v("root")]),t._v(" 目录下，输入")])]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("keygen "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("m PEM "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t rsa "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v("\n\n# 生成密钥文件，连续按下两次回车。\n# 请注意：您不应该为您生成的私钥设置密码（将其保留为空）。因为 rsync ssh（用于部署）不支持将私钥密码作为命令行参数输入。\n")])])]),s("ul",[s("li",[t._v("此时， "),s("code",[t._v("/root/.ssh/")]),t._v(" 下生成了私钥文件 "),s("code",[t._v("id_dsa")]),t._v(" 、公钥文件"),s("code",[t._v("id_dsa.pub")]),t._v(" ，根据公钥文件生成"),s("code",[t._v("authorized_keys")]),t._v(" ，并给以上三个文件分别设置权限。")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("cat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("id_rsa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pub "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("authorized_keys\n")])])]),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("chmod "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("id_rsa\n")])])]),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("chmod "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("id_rsa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pub\n")])])]),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("chmod "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("authorized_keys\n")])])]),s("ul",[s("li",[t._v("此时，客观上服务器端的工作就完成了，如果连接中遇到各种错误提示，请自行 "),s("strong",[t._v("goggle")]),t._v(" ，这里就不赘述了。")])]),t._v(" "),s("h3",{attrs:{id:"项目中设置仓库密钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目中设置仓库密钥"}},[t._v("#")]),t._v(" 项目中设置仓库密钥")]),t._v(" "),s("ul",[s("li",[t._v("说来真是坑，最开始把"),s("strong",[t._v("仓库密钥")]),t._v("错填到"),s("strong",[t._v("代码空间机密")]),t._v("中，一直连接不上，我还以为是服务器的问题，前天甚至弄恍惚了，不小心 "),s("code",[t._v("rm -rf /")]),t._v(" 了......")])]),t._v(" "),s("details",[s("summary",[t._v("\n仓库机密在GitHub项目中设置的位置\n")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/github-actions-deploy/3.png",alt:""}})])]),t._v(" "),s("ul",[s("li",[t._v("在服务器中 "),s("code",[t._v("cat")]),t._v(" 密钥，将所有内容复制到上图的 "),s("strong",[t._v("SSH_PRIVATE_KEY")]),t._v(" 中，并填入服务器IP到 "),s("strong",[t._v("REMOTE_HOST")]),t._v(" ，填入 "),s("code",[t._v("root")]),t._v(" 到 "),s("strong",[t._v("REMOTE_USER")]),t._v("。（或者直接在yml文件中填入 "),s("strong",[t._v('"root"')]),t._v(" ）")])]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("cat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("id_rsa\n")])])]),s("p",[t._v("或者")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("REMOTE_USER"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v("\n")])])]),s("h3",{attrs:{id:"发布部署文件到远端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#发布部署文件到远端"}},[t._v("#")]),t._v(" 发布部署文件到远端")]),t._v(" "),s("ul",[s("li",[t._v("我把自动发布nginx-proxy-manager静态页面的文件po在下面，请根据自身的运行环境和依赖进行修改配置即可。")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当前工作流的名称")]),t._v("\nname: sub-web-deploy\non:\n  push:\n    branches:\n      - master\n\njobs: "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建的任务，一个工作流有多个构建任务，")]),t._v("\n  build-and-deploy:\n    runs-on: ubuntu-latest "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在什么服务器上面执行这些任务，这里使用最新版本的ubuntu")]),t._v("\n    \n    steps: "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建任务的步骤，一个任务可分为多个步骤")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切换分支")]),t._v("\n      - name: Checkout\n        uses: actions/checkout@v4\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 步骤2 给当前服务器安装node")]),t._v("\n      - name: use "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),t._v("\n        uses: actions/setup-node@v3.8.1\n        with:\n          node-version: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\n          cache: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 步骤3 下载项目依赖    ")]),t._v("\n      - name: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n        run: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 步骤4 打包node项目")]),t._v("\n      - name: build\n        run: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" build\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 步骤5 部署项目到服务器")]),t._v("\n      - name: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" deploy\n        uses: easingthemes/ssh-deploy@v4.1.10\n        with:\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Private key part of an SSH key pair")]),t._v("\n          SSH_PRIVATE_KEY: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.SSH_PRIVATE_KEY }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Remote host")]),t._v("\n          REMOTE_HOST: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.REMOTE_HOST }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Remote user")]),t._v("\n          REMOTE_USER: "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.REMOTE_USER }")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Source directory, path relative to `$GITHUB_WORKSPACE` root, eg: `dist/`")]),t._v("\n          SOURCE: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/dist/"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Script to run on host machine before rsync")]),t._v("\n          SCRIPT_BEFORE: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mkdir -p /data/docker_data/npm/data/sub.ven2s.cn"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Target directory")]),t._v("\n          TARGET: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/data/docker_data/npm/data/sub.ven2s.cn/"')]),t._v("\n")])])]),s("h2",{attrs:{id:"如果喜欢请分享此页面-如有疑问请按f5-再进行评论。哈哈"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如果喜欢请分享此页面-如有疑问请按f5-再进行评论。哈哈"}},[t._v("#")]),t._v(" 如果喜欢请分享此页面，如有疑问请按F5，再进行评论。哈哈")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/github-actions-deploy/4.png",alt:""}})])])}),[],!1,null,null,null);s.default=n.exports}}]);