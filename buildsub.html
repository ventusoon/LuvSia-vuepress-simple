<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>搭建属于自己的订阅转换链接 | LuSia Ventus</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut icon" href="/images/圆形pink.png">
    <meta name="description" content="Ventus` Blog">
    <meta name="keywords" content="LuSia Ventus, Ventus, vuepress-theme-simple, 博客, vue">
    <meta name="author" content="Ventus">
    
    <link rel="preload" href="/assets/css/3.styles.0523860e.css" as="style"><link rel="preload" href="/assets/js/app.daa4b047.js" as="script"><link rel="preload" href="/assets/js/0.64ac24e1.js" as="script"><link rel="preload" href="/assets/js/16.b4c21cfd.js" as="script"><link rel="prefetch" href="/assets/js/1.ea54e935.js"><link rel="prefetch" href="/assets/js/10.4e625bc9.js"><link rel="prefetch" href="/assets/js/11.afa8792e.js"><link rel="prefetch" href="/assets/js/12.05da46fb.js"><link rel="prefetch" href="/assets/js/13.48c7aea7.js"><link rel="prefetch" href="/assets/js/14.948e450b.js"><link rel="prefetch" href="/assets/js/15.9df52e2d.js"><link rel="prefetch" href="/assets/js/17.979b1c37.js"><link rel="prefetch" href="/assets/js/18.d3e10269.js"><link rel="prefetch" href="/assets/js/19.98b1b60e.js"><link rel="prefetch" href="/assets/js/20.3be70d4f.js"><link rel="prefetch" href="/assets/js/21.c9283b8e.js"><link rel="prefetch" href="/assets/js/22.149cecca.js"><link rel="prefetch" href="/assets/js/23.67125a57.js"><link rel="prefetch" href="/assets/js/24.36b5ef6d.js"><link rel="prefetch" href="/assets/js/4.669b3083.js"><link rel="prefetch" href="/assets/js/5.1a2bf215.js"><link rel="prefetch" href="/assets/js/6.fa23b811.js"><link rel="prefetch" href="/assets/js/7.2df3f4b8.js"><link rel="prefetch" href="/assets/js/8.eee1554a.js"><link rel="prefetch" href="/assets/js/9.a6a7b906.js">
    <link rel="stylesheet" href="/assets/css/3.styles.0523860e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container vuepress-theme-simple"><header class="header"><a href="/" title="Ventus` Blog" class="site-name router-link-active">
      LuSia Ventus
    </a> <div style="clear: both"></div> <!----></header> <section class="post-view"><div class="post-head"><h1 class="post-title">
      搭建属于自己的订阅转换链接
    </h1> <time datetime="2/7/2023, 9:30:00 AM" title="2/7/2023, 9:30:00 AM" pubdate="pubdate" class="post-date">
  8 months ago
</time></div> <div class="content__default"><h1 id="sub-web-modify前端搭建"><a href="#sub-web-modify前端搭建" class="header-anchor">#</a> <a href="https://github.com/youshandefeiyang/sub-web-modify" target="_blank" rel="noopener noreferrer">Sub-Web-Modify前端搭建<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h1> <p><a href="https://sub.luvsia.com" target="_blank" rel="noopener noreferrer">本项目<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>基于<a href="https://github.com/CareyWang/sub-web" target="_blank" rel="noopener noreferrer">CareyWang/sub-web<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，重制CSS样式，解决大部分布局细节问题，增加“暗黑模式”，默认自动切换亮/暗模式（点击“太阳/月亮”图标可手动切换），增加“高级功能”点击显示/隐藏，添加短链接选择/自定义功能，增加近百条远程配置，新增<a href="https://github.com/youshandefeiyang/sub-web-api" target="_blank" rel="noopener noreferrer">sub-web聚合API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，增加上传自定义远程配置/JS进阶排序节点/JS进阶筛选节点等功能！</p> <h2 id="更新系统并安装-node-与-yarn"><a href="#更新系统并安装-node-与-yarn" class="header-anchor">#</a> 更新系统并安装 Node 与 Yarn</h2> <p>依次运行下面四行代码，若是 CentOS 系统，请自行替换下面前两行命令中的 <strong><code>apt</code></strong> 为 <strong><code>yum</code></strong></p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>apt update <span class="token operator">-</span>y
apt install <span class="token operator">-</span>y curl wget sudo nodejs git
apt install npm
npm install <span class="token operator">-</span>g yarn
</code></pre></div><p>命令执行完毕以后，请运行下面的代码查询 Node 与 Yarn 是否安装成功，若是成功会返回版本号。</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>node <span class="token operator">-</span>v
yarn <span class="token operator">--</span>version
</code></pre></div><h2 id="下载并安装-sub-web-modify"><a href="#下载并安装-sub-web-modify" class="header-anchor">#</a> 下载并安装 sub-web-modify</h2> <p>拉取 <strong><code>sub-web-modify</code></strong> 程序，并进入 <strong><code>sub-web-modify</code></strong> 文件夹</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>git clone https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>youshandefeiyang<span class="token operator">/</span>sub<span class="token operator">-</span>web<span class="token operator">-</span>modify<span class="token punctuation">.</span>git
cd sub<span class="token operator">-</span>web<span class="token operator">-</span>modify
</code></pre></div><p>在项目目录中安装构建依赖项，构建的过程稍微有点长</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>yarn install
</code></pre></div><p>使用 webpack 运行 Web 客户端以进行本地开发。</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>yarn serve
</code></pre></div><p>出现下图则表示前端调试模式启动成功</p> <p><img src="https://raw.githubusercontent.com/ventusoon/LuvSia/gh-pages/images/buildSUB/yarn-success.png" alt="yarn-success"></p> <h4 id="这时-我们浏览器访问-http-服务器ip-8080-应该可以进行前端-sub-web-modify-的预览了"><a href="#这时-我们浏览器访问-http-服务器ip-8080-应该可以进行前端-sub-web-modify-的预览了" class="header-anchor">#</a> 这时，我们浏览器访问 <a href="http://xn--ip-fr5c86lx7z:8080/" target="_blank" rel="noopener noreferrer">http://服务器ip:8080/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 应该可以进行前端 sub-web-modify 的预览了</h4> <h4 id="记住8082端口的防火墙和安全组要开放"><a href="#记住8082端口的防火墙和安全组要开放" class="header-anchor">#</a> <em>记住8082端口的防火墙和安全组要开放</em></h4> <h2 id="修改默认后端地址并增加远程规则"><a href="#修改默认后端地址并增加远程规则" class="header-anchor">#</a> 修改默认后端地址并增加远程规则</h2> <p>找到 VPS /root/sub-web-modify/src/views/Subconverter.vue 文件用编辑器打开</p> <p>找到 backendOptions:将你解析好的后端地址输入进去。域名为你刚才准备的后端域名，要将http改成https，并且增加/sub?的后缀。（这样选项下面就会出现自己的后端地址）</p> <p>如果不想用后端作者默认提供的转换那可以把 const defaultBackend = 也改成你自己的域名记得加上 &quot;&quot;。</p> <p>找到 remoteConfig: [ 后回车将喜欢的规则复制进去即可。</p> <h2 id="配置完毕后打包网站"><a href="#配置完毕后打包网站" class="header-anchor">#</a> 配置完毕后打包网站</h2> <p>配置完毕以后，程序会自动更新，再次刷新前端网页，会出现刚才添加的相关规则。</p> <p>经过上面的修改默认后端地址和原程配置的规则就修改好了。</p> <p>至此，我们的前端调试完毕，我们现在需要打包，生成一个发布目录并将他发布了。</p> <p>首先停止调试程序，CTRL+C ，退出当前调试，然后执行下面的命令进行打包：</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>yarn build
</code></pre></div><p>执行以下打包命令，在 /root/sub-web-modify 下面会生成一个 dist 目录，这个目录即为网页的发布目录。</p> <p>将这个目录的里面的文件复制到你站点的根目录即可。</p> <h2 id="一键搭建前端"><a href="#一键搭建前端" class="header-anchor">#</a> 一键搭建前端</h2> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>cd <span class="token operator">/</span>root <span class="token operator">&amp;&amp;</span> git clone https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>youshandefeiyang<span class="token operator">/</span>sub<span class="token operator">-</span>web<span class="token operator">-</span>modify<span class="token punctuation">.</span>git <span class="token operator">&amp;&amp;</span> chmod <span class="token operator">-</span><span class="token constant">R</span> <span class="token number">755</span> sub<span class="token operator">-</span>web<span class="token operator">-</span>modify <span class="token operator">&amp;&amp;</span> cd sub<span class="token operator">-</span>web<span class="token operator">-</span>modify <span class="token operator">&amp;&amp;</span> yarn install <span class="token operator">&amp;&amp;</span> yarn build
</code></pre></div><h2 id="发布前端"><a href="#发布前端" class="header-anchor">#</a> 发布前端</h2> <p>没有安装宝塔的去宝塔官网看教程安装.</p> <p>在宝塔面板中点击增加站点分别将前端站点增加上去，并配置好ssl证书。</p> <p>将 /root/sub-web/dist文件夹内的所有文件复制到前端站点的根目录下即可。</p> <p>访问该网站，前端就部署好了。</p> <h1 id="subconverter后端搭建"><a href="#subconverter后端搭建" class="header-anchor">#</a> <a href="https://github.com/tindy2013/subconverter" target="_blank" rel="noopener noreferrer">SubConverter后端搭建<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h1> <h2 id="新建后端站点并进行反向代理"><a href="#新建后端站点并进行反向代理" class="header-anchor">#</a> 新建后端站点并进行反向代理</h2> <p>在宝塔面板中新建后端的站点，同样配置好ssl并将设置站点的反向代理到25500。</p> <p>点击新建好的后端网站的网站名在弹出来的消息盒子中点击反向代理添加发现代理。</p> <p>反向代理配置方法方法如图：</p> <p><img src="https://raw.githubusercontent.com/ventusoon/LuvSia/gh-pages/images/buildSUB/buildSUB.png" alt="反代"></p> <p>设置完毕后我们开始安装后端</p> <h2 id="搭建后端程序"><a href="#搭建后端程序" class="header-anchor">#</a> 搭建后端程序</h2> <h3 id="这里我们可以用两种方法搭建后端程序-第一种是用二进制文件搭建-第二种为使用docker搭建。我个人比较推荐docker配置简单一行命令即可搞定"><a href="#这里我们可以用两种方法搭建后端程序-第一种是用二进制文件搭建-第二种为使用docker搭建。我个人比较推荐docker配置简单一行命令即可搞定" class="header-anchor">#</a> 这里我们可以用两种方法搭建后端程序，第一种是用二进制文件搭建，第二种为使用Docker搭建。我个人比较推荐Docker配置简单一行命令即可搞定</h3> <h4 id="方法一-二进制文件搭建"><a href="#方法一-二进制文件搭建" class="header-anchor">#</a> 方法一 二进制文件搭建</h4> <h5 id="下载并解压-subconverter-二进制文件"><a href="#下载并解压-subconverter-二进制文件" class="header-anchor">#</a> 下载并解压 subconverter 二进制文件</h5> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>cd <span class="token operator">/</span>root
wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>tindy2013<span class="token operator">/</span>subconverter<span class="token operator">/</span>releases<span class="token operator">/</span>download<span class="token operator">/</span>v0<span class="token punctuation">.</span><span class="token number">7.2</span><span class="token operator">/</span>subconverter_linux64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
tar <span class="token operator">-</span>zxvf subconverter_linux64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
</code></pre></div><h3 id="完成以后-在-root-文件夹下会多出一个-subconverter-的文件夹-这个就是我们的后端程序"><a href="#完成以后-在-root-文件夹下会多出一个-subconverter-的文件夹-这个就是我们的后端程序" class="header-anchor">#</a> <em>完成以后，在 /root 文件夹下会多出一个 subconverter 的文件夹，这个就是我们的后端程序</em></h3> <h5 id="修改配置文件参数"><a href="#修改配置文件参数" class="header-anchor">#</a> 修改配置文件参数</h5> <p>现在我们需要修改后端配置文件中的一些参数</p> <p>找到VPS文件 /root/subconverter/pref.ini ，找到如下参数进行修改</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>api_access_token<span class="token operator">=</span>123123dfsdsdfsdfsdf            #随意设置自己知道就行
managed_config_prefix<span class="token operator">=</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>sub<span class="token punctuation">.</span>yourdomin<span class="token punctuation">.</span>com  #设置成我们刚刚解析的后端域名
listen<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>                                #这里改成 <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> 进行反代
</code></pre></div><h5 id="创建服务进程并启动"><a href="#创建服务进程并启动" class="header-anchor">#</a> 创建服务进程并启动</h5> <p>接下来我们需要创建一个服务，让VPS每次重启或是开机自动运行后端程序</p> <p>找到VPS目录 /etc/systemd/system，创建一个名为 sub.service 的文件</p> <p>打开文件，贴入以下内容，保存。</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
Description<span class="token operator">=</span><span class="token constant">A</span> <span class="token constant">API</span> For Subscription Convert
After<span class="token operator">=</span>network<span class="token punctuation">.</span>target
 
<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
Type<span class="token operator">=</span>simple
ExecStart<span class="token operator">=</span><span class="token operator">/</span>root<span class="token operator">/</span>subconverter<span class="token operator">/</span>subconverter
WorkingDirectory<span class="token operator">=</span><span class="token operator">/</span>root<span class="token operator">/</span>subconverter
Restart<span class="token operator">=</span>always
RestartSec<span class="token operator">=</span><span class="token number">10</span>
 
<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
WantedBy<span class="token operator">=</span>multi<span class="token operator">-</span>user<span class="token punctuation">.</span>target
</code></pre></div><h5 id="检查运行状态以及设置开机自启"><a href="#检查运行状态以及设置开机自启" class="header-anchor">#</a> 检查运行状态以及设置开机自启</h5> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>systemctl daemon<span class="token operator">-</span>reload
systemctl start sub
systemctl enable sub
systemctl status sub
</code></pre></div><h3 id="到这里-后端也就搭建完毕了-我们现在可以在浏览器里面访问我们的后端了-访问后端域名后端搭建成功"><a href="#到这里-后端也就搭建完毕了-我们现在可以在浏览器里面访问我们的后端了-访问后端域名后端搭建成功" class="header-anchor">#</a> <em>到这里，后端也就搭建完毕了，我们现在可以在浏览器里面访问我们的后端了，访问后端域名后端搭建成功！</em></h3> <h4 id="方法二-docker容器搭建"><a href="#方法二-docker容器搭建" class="header-anchor">#</a> 方法二 Docker容器搭建</h4> <p>如果服务器安装了Docker可以使用命令：</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>docker run <span class="token operator">-</span>d <span class="token operator">--</span>restart<span class="token operator">=</span>always <span class="token operator">-</span>p <span class="token number">25500</span><span class="token operator">:</span><span class="token number">25500</span> tindy2013<span class="token operator">/</span>subconverter<span class="token operator">:</span>latest
</code></pre></div><p>然后再用下面的命令确认一下状态</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>curl http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">25500</span><span class="token operator">/</span>version
curl http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">25500</span><span class="token operator">/</span>version
</code></pre></div><p>如果输出当前 subconverter 容器版本几位搭建成功。</p></div></section> <footer class="footer">
  © 2023
  <i class="icon-user"></i>
  Ventus
  <br>
  Powered by
  <a href="https://vuepress.vuejs.org/" rel="noopener" target="_blank">VuePress</a>
  | Theme
  <a href="https://github.com/viko16/vuepress-theme-simple" rel="noopener" target="_blank">Simple</a></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.daa4b047.js" defer></script><script src="/assets/js/0.64ac24e1.js" defer></script><script src="/assets/js/16.b4c21cfd.js" defer></script>
  </body>
</html>
