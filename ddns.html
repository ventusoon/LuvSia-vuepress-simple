<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cloudflare + DDNS-GO + RDP | LuSia Ventus</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut icon" href="/images/圆形pink.png">
    <meta name="description" content="Ventus` Blog">
    <meta name="keywords" content="LuSia Ventus, Ventus, vuepress-theme-simple, 博客, vue">
    <meta name="author" content="Ventus">
    
    <link rel="preload" href="/assets/css/3.styles.0523860e.css" as="style"><link rel="preload" href="/assets/js/app.daa4b047.js" as="script"><link rel="preload" href="/assets/js/0.64ac24e1.js" as="script"><link rel="preload" href="/assets/js/12.05da46fb.js" as="script"><link rel="prefetch" href="/assets/js/1.ea54e935.js"><link rel="prefetch" href="/assets/js/10.4e625bc9.js"><link rel="prefetch" href="/assets/js/11.afa8792e.js"><link rel="prefetch" href="/assets/js/13.48c7aea7.js"><link rel="prefetch" href="/assets/js/14.948e450b.js"><link rel="prefetch" href="/assets/js/15.9df52e2d.js"><link rel="prefetch" href="/assets/js/16.b4c21cfd.js"><link rel="prefetch" href="/assets/js/17.979b1c37.js"><link rel="prefetch" href="/assets/js/18.d3e10269.js"><link rel="prefetch" href="/assets/js/19.98b1b60e.js"><link rel="prefetch" href="/assets/js/20.3be70d4f.js"><link rel="prefetch" href="/assets/js/21.c9283b8e.js"><link rel="prefetch" href="/assets/js/22.149cecca.js"><link rel="prefetch" href="/assets/js/23.67125a57.js"><link rel="prefetch" href="/assets/js/24.36b5ef6d.js"><link rel="prefetch" href="/assets/js/4.669b3083.js"><link rel="prefetch" href="/assets/js/5.1a2bf215.js"><link rel="prefetch" href="/assets/js/6.fa23b811.js"><link rel="prefetch" href="/assets/js/7.2df3f4b8.js"><link rel="prefetch" href="/assets/js/8.eee1554a.js"><link rel="prefetch" href="/assets/js/9.a6a7b906.js">
    <link rel="stylesheet" href="/assets/css/3.styles.0523860e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container vuepress-theme-simple"><header class="header"><a href="/" title="Ventus` Blog" class="site-name router-link-active">
      LuSia Ventus
    </a> <div style="clear: both"></div> <!----></header> <section class="post-view"><div class="post-head"><h1 class="post-title">
      Cloudflare + DDNS-GO + RDP
    </h1> <time datetime="3/27/2023, 1:22:22 PM" title="3/27/2023, 1:22:22 PM" pubdate="pubdate" class="post-date">
  6 months ago
</time></div> <div class="content__default"><blockquote><p><em><strong>Using DDNS and Port forwarding to achieve remote access to devices on an internal network</strong></em></p></blockquote> <h1 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h1> <ul><li><p><strong>最近迷上了AI画图软件 <em><code>stable-diffusion-webui</code></em> ，由于它对 <em><code>GPU</code></em> 的依赖很大，我只能使用家里的电脑来炼丹（也就一张6年前的1060😥），奈何又在外地上班，只能走进了我一直望而却步的动态域名解析服务，来实现远程控制家中电脑，以及其他网络设备的目的。</strong></p> <p><img src="/images/DDNS/Z.jpg" alt="Z" title=":smirk:"> <img src="/images/DDNS/B.jpg" alt="D" title=":smirk:"> <img src="/images/DDNS/0.jpg" alt="B" title=":smirk:"></p></li> <li><p><strong>写本篇教程（备忘录），一是彰显成就感，二是带给大家一些思路，让有相同需求的朋友少走弯路（毕竟我找了很多教程都没有说清楚DDNS到底是个什么，又要怎么使用）。</strong></p></li> <li><p><a href="https://baike.baidu.com/item/ddns/670146" target="_blank" rel="noopener noreferrer"><em>DDNS</em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（全名：<em>Dynamic Domain Name Server</em>），动态域名服务，说人话就是将家中内网的动态 <code>ipv4</code> 地址映射到一个固定的域名解析服务上。</p></li> <li><p><a href="https://www.cloudflare.com/" target="_blank" rel="noopener noreferrer"><em>Cloudflare</em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 全球知名的DNS服务商。</p></li> <li><p><a href="https://github.com/jeessy2/ddns-go" target="_blank" rel="noopener noreferrer"><em>DDNS-GO</em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 超好用的DDNS解析服务工具。感谢作者大大解决了我最关键的问题。</p></li> <li><p><a href="https://baike.baidu.com/item/%E5%85%AC%E7%BD%91IP" target="_blank" rel="noopener noreferrer">公网 <em>IP</em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 不得不说电信的服务水平，半天时间真就给我开通了，这里就不说这玩意儿怎么用了，接触网络的人基本都知道，虽然现在有很多办法可以绕过公网 <em><code>IP</code></em> 来访问内网，但是通过我的测试，用了很多的远程连接服务和内网穿透工具，还是最原始的办法性价比更高，体验更是一流。</p> <p><img src="/images/DDNS/1.png" alt="RDP" title="可以看到这里的延迟十分之低"></p></li></ul> <h2 id="开工"><a href="#开工" class="header-anchor">#</a> 开工</h2> <ul><li><p><strong>开始之前先简单说下我家里的网络布局，弱电箱一个光猫桥接模式，一个主路由负责拨号，卧室一个 <em><code>K2P</code></em> 路由 <em><code>ap</code></em> 模式，一个旧笔记本电脑充当软路由（旁路由），安装了 <em><code>PVE</code></em> ，<em><code>PVE</code></em> 上使用了 <em><code>openWRT</code></em>，还有一台台式电脑，忘了在 <em><code>visio</code></em> 上画出来。</strong></p> <p><img src="/images/DDNS/2.png" alt="网络布局" title="网络布局图"></p></li> <li><p>不要问我为什么不在 <em><code>openWRT</code></em> 上 <em><code>DHCP</code></em> ，我试了很多次都无法联网，可能是因为网口绑定了 <em><code>MAC</code></em> 地址，我也不知道怎么取消绑定，所以我只能在主路由上绑定我电脑的 <em><code>MAC</code></em> 才能上网。（可能也不是这个原因，我在 <em><code>openWRT</code></em> 上绑定 <em><code>WAN</code></em> 口地址也不能上网。）<strong>我家的网络环境真的太复杂了😥</strong></p></li></ul> <h2 id="正式开始"><a href="#正式开始" class="header-anchor">#</a> 正式开始</h2> <ul><li><strong>下载<a href="https://github.com/jeessy2/ddns-go/releases" target="_blank" rel="noopener noreferrer"><em><code>DDNS-GO</code></em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>到本地并解压，使用管理员权限CD到根目录</strong></li></ul> <p>安装</p> <div class="language-bash extra-class"><pre class="language-bash"><code>.<span class="token punctuation">\</span>ddns-go.exe <span class="token parameter variable">-s</span> <span class="token function">install</span>
</code></pre></div><p>卸载</p> <div class="language-bash extra-class"><pre class="language-bash"><code>.<span class="token punctuation">\</span>ddns-go.exe <span class="token parameter variable">-s</span> uninstall
</code></pre></div><p><img src="/images/DDNS/3.png" alt="DDNS-GO" title="DDNS-GO"></p> <ul><li><p><strong>安装好后，在服务中可以看到 <em><code>ddns-go</code></em> 服务，并设置自启动</strong></p> <p><img src="/images/DDNS/4.png" alt="DDNS-GO服务" title="DDNS-GO服务开启"></p></li> <li><p><strong>打开 <a href="http://127.0.0.1:9876" target="_blank" rel="noopener noreferrer"><em><code>http://127.0.0.1:9876</code></em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，可以看到 <em><code>ddns-go</code></em> 支持很多家动态解析服务商</strong></p> <p><img src="/images/DDNS/5.png" alt="DDNS-GO配置1" title="DDNS-GO页面"></p></li> <li><p><strong>去 <em><code>cloudflare</code></em> 获取 <em><code>API</code></em> 令牌既上图中的 <em><code>Token</code></em> ，重点注意区域资源要选所有区域</strong></p> <p><img src="/images/DDNS/6.png" alt="cloudflare配置1" title="cloudflare配置"> <img src="/images/DDNS/7.png" alt="cloudflare配置2" title="一定要选所有区域"></p></li> <li><p><strong>回到 <em><code>DDNS-GO</code></em> 中如下图，像我一样配置即可，有公网的只勾选 <em><code>IPv4</code></em> ，没有公网的选 <em><code>IPv6</code></em> （我两个都有，所以都选了，你也可以，经测试无伤大雅），在主机名后面填上你的<code>域名</code>。至于如何获得 <em><code>IPv6</code></em> ，这个我下次再做一个详细的教程。（推荐一个好用的<a href="https://cf-ns.com/cdn-cgi/trace" target="_blank" rel="noopener noreferrer">CF国内API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，可以准确获取你的 <em><code>IP</code></em> 本地地址，无论你是否使用科学上网工具）</strong></p> <p><img src="/images/DDNS/8.png" alt="DDNS-GO配置2" title="IPv4"> <img src="/images/DDNS/9.png" alt="DDNS-GO配置3" title="IPv6"> <img src="/images/DDNS/10.png" alt="DDNS-GO配置4" title="选择是否外网连接，以及设置访问账号密码"></p></li> <li><p><strong>点击保存后，成功后，你会在 <em>Cloudflare</em> 上你的域名 <em><code>dns</code></em> 服务中看到你已经解析了的A记录（IPv4地址）或者AAAA记录（IPv6地址），<em><code>ddns-go</code></em> 中你也可以看到解析成功的提示</strong></p></li> <li><p><strong>到此，你终于成功解析你的动态IP，在主路由、旁路由上设置好端口转发服务，就可以随时随地访问家中的设备。</strong></p></li></ul> <h2 id="抽时间-再把如何有效的进行端口转发记录下来-以防我这个狗脑子又忘了"><a href="#抽时间-再把如何有效的进行端口转发记录下来-以防我这个狗脑子又忘了" class="header-anchor">#</a> 抽时间，再把如何有效的进行端口转发记录下来，以防我这个狗脑子又忘了</h2></div></section> <footer class="footer">
  © 2023
  <i class="icon-user"></i>
  Ventus
  <br>
  Powered by
  <a href="https://vuepress.vuejs.org/" rel="noopener" target="_blank">VuePress</a>
  | Theme
  <a href="https://github.com/viko16/vuepress-theme-simple" rel="noopener" target="_blank">Simple</a></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.daa4b047.js" defer></script><script src="/assets/js/0.64ac24e1.js" defer></script><script src="/assets/js/12.05da46fb.js" defer></script>
  </body>
</html>
